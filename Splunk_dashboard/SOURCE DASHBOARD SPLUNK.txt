{
    "dataSources": {
        "ds_pMR7Par9": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status=\"failed\"\r\n| where Severity=\"Medium\" \r\n| bin _time span=1d\r\n| stats count as passed_count by _time\r\n| sort - _time\r\n| head 2\r\n| reverse",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "Medium_today"
        },
        "ds_T0vHaPfb": {
            "type": "ds.search",
            "options": {
                "query": "index=dc1_ad\r\n| where status = \"failed\" \r\n| eval date_only=strftime(_time, \"%Y-%m-%d\")  \r\n| stats count by date_only, Severity  \r\n| eval Severity=lower(Severity)  \r\n| chart sum(count) as count over date_only by Severity  \r\n| sort - date_only  \r\n| head 7\r\n| reverse",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "Security_events_7day_area"
        },
        "ds_HWl0syoc": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\n| stats count by Severity",
                "queryParameters": {
                    "earliest": "$tr_3W94Yr81.earliest$",
                    "latest": "$tr_3W94Yr81.latest$"
                }
            },
            "name": "Severity_Pie"
        },
        "ds_rL2ongs4": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$ \r\n| stats count by status\r\n",
                "queryParameters": {
                    "earliest": "$tr_3W94Yr81.earliest$",
                    "latest": "$tr_3W94Yr81.latest$"
                }
            },
            "name": "ds_pie_status"
        },
        "ds_i6xaqLMw_ds_SUpYgTZ6": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status=\"failed\"\r\n| bin _time span=1d\r\n| stats count as passed_count by _time\r\n| sort - _time\r\n| head 2\r\n| reverse",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "Search_Fail_Today"
        },
        "ds_1sTm9SHG": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| search status=passed\r\n| table name\r\n| rename name as PASS",
                "queryParameters": {
                    "earliest": "$tr_3W94Yr81.earliest$",
                    "latest": "$tr_3W94Yr81.latest$"
                }
            },
            "name": "table_1"
        },
        "ds_C7kiLIbb_ds_1sTm9SHG": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status = \"failed\"\r\n| search Severity=$severity_token$ \"Best practices\"=*\r\n| table name,\"Best practices\", Severity, \r\n",
                "queryParameters": {
                    "earliest": "$tr_3W94Yr81.earliest$",
                    "latest": "$tr_3W94Yr81.latest$"
                }
            },
            "name": "table_Severity"
        },
        "ds_HCJIRnfA_ds_SUpYgTZ6": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status = \"passed\" \r\n| stats count as passed_count",
                "queryParameters": {
                    "earliest": "$tr_3W94Yr81.earliest$",
                    "latest": "$tr_3W94Yr81.latest$"
                }
            },
            "name": "Search_Pass_today copy 1"
        },
        "ds_cakMrK2h_ds_HCJIRnfA_ds_SUpYgTZ6": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status = \"failed\" \r\n| stats count as failed_count",
                "queryParameters": {
                    "earliest": "$tr_3W94Yr81.earliest$",
                    "latest": "$tr_3W94Yr81.latest$"
                }
            },
            "name": "Search_Pass_today copy 2"
        },
        "ds_LkXDbuWx_ds_XBwZVwxb_ds_cakMrK2h_ds_HCJIRnfA_ds_SUpYgTZ6": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status = \"failed\"\r\n| where Severity = \"High\" \r\n| stats count as high_count",
                "queryParameters": {
                    "earliest": "$tr_3W94Yr81.earliest$",
                    "latest": "$tr_3W94Yr81.latest$"
                }
            },
            "name": "Search_Pass_today copy 4"
        },
        "ds_EnJxLZjX_ds_XBwZVwxb_ds_cakMrK2h_ds_HCJIRnfA_ds_SUpYgTZ6": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status = \"failed\"\r\n| where Severity = \"Medium\" \r\n| stats count as Critical_count",
                "queryParameters": {
                    "earliest": "$tr_3W94Yr81.earliest$",
                    "latest": "$tr_3W94Yr81.latest$"
                }
            },
            "name": "Search_Pass_today copy 5"
        },
        "ds_Nj65n3BS_ds_XBwZVwxb_ds_cakMrK2h_ds_HCJIRnfA_ds_SUpYgTZ6": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status = \"failed\"\r\n| where Severity = \"Low\" \r\n| stats count as Critical_count",
                "queryParameters": {
                    "earliest": "$tr_3W94Yr81.earliest$",
                    "latest": "$tr_3W94Yr81.latest$"
                }
            },
            "name": "Search_Pass_today copy 6"
        },
        "ds_9fKeclxu_ds_pMR7Par9": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status=\"failed\"\r\n| where Severity=\"Low\" \r\n| bin _time span=1d\r\n| stats count as passed_count by _time\r\n| sort - _time\r\n| head 2\r\n| reverse",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "Medium_today copy 1"
        },
        "ds_Z1gHSYgA_ds_pMR7Par9": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status=\"failed\"\r\n| where Severity=\"High\" \r\n| bin _time span=1d\r\n| stats count as passed_count by _time\r\n| sort - _time\r\n| head 2\r\n| reverse",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "Medium_today copy 2"
        },
        "ds_ICeFyKNH_ds_5gp8soW3_ds_ZV5CUCY6": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status=\"failed\"\r\n| bin _time span=1d\r\n| stats count as passed_count by _time\r\n| sort - _time\r\n| head 7\r\n| reverse",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "search_fail_area copy 1"
        },
        "ds_vTdtSaZ7_ds_ZV5CUCY6": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status=\"passed\"\r\n| bin _time span=1d\r\n| stats count as passed_count by _time\r\n| sort - _time\r\n| head 7\r\n| reverse",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "search_pass_area copy 1"
        },
        "ds_El6r5vGX_ds_i6xaqLMw_ds_SUpYgTZ6": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status=\"passed\"\r\n| bin _time span=1d\r\n| stats count as passed_count by _time\r\n| sort - _time\r\n| head 2\r\n| reverse",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "Search_Fail_Today copy 1"
        },
        "ds_zhrtLsDt": {
            "type": "ds.search",
            "options": {
                "query": "index=dc1_apv\r\n| eventstats max(_time) as latest_time\r\n| where _time = latest_time\r\n| where secured_object_type=\"user\"\r\n| fields secured_object, permission, secured_object_type, security_principal, security_principal_type\r\n| search  secured_object!=null AND secured_object_type!=null\r\n| table secured_object, permission, security_principal, security_principal_type\r\n| rename secured_object as \"Secure Object\", security_principal as \"Secure Principal\", security_principal_type as \"Secure Principal Type\", permission as Permission\r\n",
                "queryParameters": {
                    "earliest": "-24h@h",
                    "latest": "now"
                }
            },
            "name": "Search_3"
        },
        "ds_8gOBTwfo_ds_zhrtLsDt": {
            "type": "ds.search",
            "options": {
                "query": "index=dc1_apv\r\n| eventstats max(_time) as latest_time\r\n| where _time = latest_time\r\n| where secured_object_type=\"group\"\r\n| fields secured_object, permission, secured_object_type, security_principal, security_principal_type\r\n| search  secured_object!=null AND secured_object_type!=null\r\n| table secured_object, permission, security_principal, security_principal_type\r\n| rename secured_object as \"Secure Object\", security_principal as \"Secure Principal\", security_principal_type as \"Secure Principal Type\", permission as Permission",
                "queryParameters": {
                    "earliest": "-24h@h",
                    "latest": "now"
                }
            },
            "name": "Search_3 copy 2"
        },
        "ds_pUYGVK3Z_ds_8gOBTwfo_ds_zhrtLsDt": {
            "type": "ds.search",
            "options": {
                "query": "index=dc1_apv\r\n| eventstats max(_time) as latest_time\r\n| where _time = latest_time\r\n| where secured_object_type=\"domains\"\r\n| fields secured_object, permission, secured_object_type, security_principal, security_principal_type\r\n| search  secured_object!=null AND secured_object_type!=null\r\n| table secured_object, permission, security_principal, security_principal_type\r\n| rename secured_object as \"Secure Object\", security_principal as \"Secure Principal\", security_principal_type as \"Secure Principal Type\", permission as Permission",
                "queryParameters": {
                    "earliest": "-24h@h",
                    "latest": "now"
                }
            },
            "name": "Search_3 copy 3"
        },
        "ds_6WXA5c0S": {
            "type": "ds.search",
            "options": {
                "query": "| inputlookup Dangerous_Priveleges.csv",
                "queryParameters": {
                    "earliest": "-24h@h",
                    "latest": "now"
                }
            },
            "name": "Search_1"
        },
        "ds_7k7ZJFzH_ds_1sTm9SHG": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_fail$\r\n| search Stage=$Stage$\r\n| eventstats max(_time) as latest_time\r\n| where _time = latest_time\r\n| table ID, Name, Stage\r\n| rename Name as FAIL\r\n| sort ID",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "table_1 copy 1"
        },
        "ds_GkPA2jsd": {
            "type": "ds.search",
            "options": {
                "query": "index=dc1_service\r\n| eventstats max(_time) as latest_time\r\n| where _time = latest_time\r\n| table Service, Status, Description, Mitigation",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "Search_2"
        },
        "ds_4zadPHj4": {
            "type": "ds.search",
            "options": {
                "query": "index=dc1_ad\r\n| stats dc(checklist_name)",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "Search_4"
        },
        "ds_MtOq5TPY_ds_4zadPHj4": {
            "type": "ds.search",
            "options": {
                "query": "index=dc1_ad\r\n| stats dc(name)",
                "queryParameters": {
                    "earliest": "0",
                    "latest": ""
                }
            },
            "name": "Search_4 copy 1"
        },
        "ds_bOCKEnx1": {
            "type": "ds.search",
            "options": {
                "query": "index=$Domain_name$\r\n| where status=\"passed\"\r\n| stats count as passed_count\r\n| eval percentage=round((passed_count / 113) * 100, 2)\r\n| eval result=case(\r\n    percentage > 70, \"✅\",\r\n    percentage > 50 AND percentage <= 70, \"⚠️\",\r\n    percentage <= 50, \"❗\"\r\n)\r\n| table result",
                "queryParameters": {
                    "earliest": "$tr_3W94Yr81.earliest$",
                    "latest": "$tr_3W94Yr81.latest$"
                }
            },
            "name": "Search_5"
        }
    },
    "visualizations": {
        "viz_CL6AA06J": {
            "type": "splunk.singlevalue",
            "title": "",
            "dataSources": {
                "primary": "ds_pMR7Par9"
            },
            "options": {
                "majorColor": "> majorValue | rangeValue(majorColorEditorConfig)",
                "trendColor": "> trendValue | rangeValue(trendColorEditorConfig)",
                "backgroundColor": "transparent",
                "sparklineDisplay": "off",
                "trendFontSize": 18
            },
            "context": {
                "majorColorEditorConfig": [
                    {
                        "value": "#ffffff",
                        "to": 1
                    },
                    {
                        "value": "#cba700",
                        "from": 1
                    }
                ],
                "trendColorEditorConfig": [
                    {
                        "value": "#ffffff",
                        "to": 0
                    },
                    {
                        "value": null,
                        "from": 0,
                        "to": 1
                    },
                    {
                        "value": "#ffffff",
                        "from": 1
                    }
                ]
            }
        },
        "viz_i4CumA1U": {
            "type": "splunk.markdown",
            "options": {
                "markdown": "# **Active Directory Security**\n\n\n",
                "fontSize": "custom",
                "customFontSize": 15
            }
        },
        "viz_245xhO9X": {
            "type": "splunk.markdown",
            "options": {
                "markdown": "**High**\n",
                "fontSize": "custom",
                "customFontSize": 18
            }
        },
        "viz_ChQFnAFK": {
            "type": "splunk.markdown",
            "options": {
                "markdown": "**Medium**\n",
                "fontSize": "custom",
                "customFontSize": 18
            }
        },
        "viz_81D7tTKQ": {
            "type": "splunk.markdown",
            "options": {
                "markdown": "**Low**\n",
                "fontSize": "custom",
                "customFontSize": 18
            }
        },
        "viz_N5C6sQK6": {
            "type": "splunk.area",
            "title": "",
            "dataSources": {
                "primary": "ds_T0vHaPfb"
            },
            "hideWhenNoData": false,
            "containerOptions": {},
            "showProgressBar": false,
            "showLastUpdated": false,
            "options": {
                "seriesColors": [
                    "#7B56DB",
                    "#009CEB",
                    "#008C80",
                    "#99B100",
                    "#E47BFE"
                ]
            }
        },
        "viz_LT17ZpIy": {
            "type": "splunk.pie",
            "options": {
                "backgroundColor": "transparent",
                "showDonutHole": true,
                "seriesColors": [
                    "#7B56DB",
                    "#009CEB",
                    "#008C80",
                    "#99B100",
                    "#FFA476",
                    "#FF6ACE",
                    "#AE8CFF",
                    "#00689D",
                    "#00490A",
                    "#465D00",
                    "#9D6300",
                    "#F6540B",
                    "#FF969E",
                    "#E47BFE"
                ],
                "labelDisplay": "valuesAndPercentage"
            },
            "dataSources": {
                "primary": "ds_HWl0syoc"
            },
            "title": ""
        },
        "viz_mQJkEIWx": {
            "type": "splunk.pie",
            "options": {
                "backgroundColor": "transparent",
                "showDonutHole": true,
                "value": "> primary | seriesByName('count')",
                "seriesColors": [
                    "#7B56DB",
                    "#009CEB",
                    "#af575a",
                    "#DD9900",
                    "#FF677B",
                    "#CB2196",
                    "#813193",
                    "#0051B5",
                    "#008C80",
                    "#99B100",
                    "#FFA476",
                    "#FF6ACE",
                    "#AE8CFF",
                    "#00689D",
                    "#00490A",
                    "#465D00",
                    "#9D6300",
                    "#F6540B",
                    "#FF969E",
                    "#E47BFE"
                ],
                "labelDisplay": "valuesAndPercentage"
            },
            "dataSources": {
                "primary": "ds_rL2ongs4"
            },
            "eventHandlers": [
                {
                    "type": "drilldown.setToken",
                    "options": {
                        "tokens": [
                            {
                                "token": "status",
                                "key": "row.<fieldname>.value"
                            }
                        ]
                    }
                }
            ]
        },
        "viz_Zp22lgFA": {
            "type": "splunk.markdown",
            "options": {
                "markdown": "### **PASS**\n",
                "fontSize": "custom",
                "customFontSize": 24,
                "fontColor": "#ffffff"
            }
        },
        "viz_MpMhSkjQ": {
            "type": "splunk.markdown",
            "options": {
                "markdown": "**FAIL**\n",
                "fontSize": "custom",
                "customFontSize": 30,
                "fontColor": "#ffffff"
            }
        },
        "viz_FIarHyn9": {
            "type": "splunk.singlevalue",
            "options": {
                "majorColor": "> majorValue | rangeValue(majorColorEditorConfig)",
                "trendColor": "> trendValue | rangeValue(trendColorEditorConfig)",
                "trendFontSize": 24,
                "backgroundColor": "transparent",
                "sparklineDisplay": "off"
            },
            "dataSources": {
                "primary": "ds_i6xaqLMw_ds_SUpYgTZ6"
            },
            "context": {
                "majorColorEditorConfig": [
                    {
                        "value": "#D41F1F",
                        "to": 20
                    },
                    {
                        "value": "#d41f1f",
                        "from": 20
                    }
                ],
                "trendColorEditorConfig": [
